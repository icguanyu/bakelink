import{_ as Q,c as l,o as t,X as ue,b as e,F as H,z as F,q as J,t as n,v as I,r as k,l as x,M as re,x as z,w as _,Y as me,K as se,L as ae,I as ve,n as G,d as a,J as le,f as oe,E as pe,Z as _e,j as fe,$ as he,k as ye,m as w,h as Z,g as be,S as te}from"./index-BxJShhSS.js";/* empty css                     *//* empty css            *//* empty css               */import{a as ke}from"./products-Dn-UQg2U.js";const ge={class:"schedule-left"},De={class:"schedule-list"},Oe=["onClick"],Pe={class:"date-section"},$e={class:"date-value"},Se={key:0,class:"mini-stats"},Te={key:0,class:"stat-badge ordered"},Re={key:1,class:"stat-badge completed"},Ce={key:2,class:"stat-badge cancelled"},Ve={key:1,class:"no-orders-tag"},Ye={__name:"ScheduleCalendar",props:{scheduleList:{type:Array,required:!0},selectedDate:{type:String,default:null}},emits:["select"],setup(S,{emit:y}){const s=y,b=g=>{s("select",g)};return(g,p)=>(t(),l("div",ge,[p[0]||(p[0]=ue('<div class="schedule-week-header" data-v-91bf7fee><div class="week-day" data-v-91bf7fee>æ—¥</div><div class="week-day" data-v-91bf7fee>ä¸€</div><div class="week-day" data-v-91bf7fee>äºŒ</div><div class="week-day" data-v-91bf7fee>ä¸‰</div><div class="week-day" data-v-91bf7fee>å››</div><div class="week-day" data-v-91bf7fee>äº”</div><div class="week-day" data-v-91bf7fee>å…­</div></div>',1)),e("div",De,[(t(!0),l(H,null,F(S.scheduleList,i=>(t(),l("div",{key:i.date,class:J(["schedule-item",{"item-selected":S.selectedDate===i.date,"not-current-month":!i.isCurrentMonth}]),onClick:V=>b(i.date)},[e("div",{class:J(["schedule-header-row",{"no-orders":!i.hasOrders}])},[e("div",Pe,[e("div",{class:J(["date-box",{saturday:i.dateObj.day()===6,sunday:i.dateObj.day()===0}])},[e("div",$e,n(i.dateObj.format("DD")),1)],2)]),i.hasOrders?(t(),l("div",Se,[i.stats.ordered>0?(t(),l("span",Te," â†“ "+n(i.stats.ordered),1)):I("",!0),i.stats.completed>0?(t(),l("span",Re," âœ“ "+n(i.stats.completed),1)):I("",!0),i.stats.cancelled>0?(t(),l("span",Ce," âœ• "+n(i.stats.cancelled),1)):I("",!0)])):(t(),l("div",Ve,"æœªé–‹å–®"))],2)],10,Oe))),128))])]))}},xe=Q(Ye,[["__scopeId","data-v-91bf7fee"]]),Me={__name:"SelectProduct",props:{modelValue:[String,Number],placeholder:{type:String,default:"è«‹é¸æ“‡ç”¢å“"},excludeIds:{type:Array,default:()=>[]},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(S,{expose:y,emit:s}){const b=S,g=k(!1),p=k([]),i=x(()=>{const r=new Set(b.excludeIds);return p.value.filter(f=>!r.has(f.id))}),V=x(()=>{const r=new Set(b.excludeIds),f=p.value.filter(O=>!r.has(O.id)),Y={};return f.forEach(O=>{const R=O.category_id,$=O.category?.name||O.category_name||"æœªåˆ†é¡ž";Y[R]||(Y[R]={label:$,categoryId:R,options:[]}),Y[R].options.push({value:O.id,label:O.name})}),Object.values(Y)}),D=async()=>{g.value=!0;try{const r=await ke.List({});console.log("products",r),p.value=r.data.data||[]}catch(r){console.error("fetch data error",r)}finally{g.value=!1}};return re(()=>{D()}),y({getProductById:r=>p.value.find(f=>f.id===r)}),(r,f)=>{const Y=se,O=me,R=ae;return t(),z(R,{modelValue:S.modelValue,onClear:f[0]||(f[0]=$=>r.$emit("update:modelValue",null)),"onUpdate:modelValue":f[1]||(f[1]=$=>r.$emit("update:modelValue",$)),placeholder:S.placeholder,loading:g.value,disabled:S.disabled||i.value.length===0},{default:_(()=>[(t(!0),l(H,null,F(V.value,$=>(t(),z(O,{key:$.categoryId,label:$.label},{default:_(()=>[(t(!0),l(H,null,F($.options,C=>(t(),z(Y,{key:C.value,label:C.label,value:C.value},null,8,["label","value"]))),128))]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","placeholder","loading","disabled"])}}},Ee={class:"schedule-editor"},we={class:"editor-header"},Ie={class:"editor-title"},Le={class:"editor-body"},Ne={class:"editor-section"},Ae={class:"field-row"},Be={class:"field-value"},He={class:"field-row"},Fe={class:"editor-section"},je={class:"section-content"},Ue={class:"field-row add-row"},ze={key:0,class:"empty-products"},We={key:1,class:"product-list"},qe={class:"product-item"},Ge={class:"product-info"},Je={class:"product-name"},Ke={class:"product-limit"},Xe={__name:"ScheduleEditor",props:{dateLabel:{type:String,default:""},initialProducts:{type:Array,default:()=>[]},initialStatus:{type:String,default:"draft"},initialStartTime:{type:String,default:""},initialEndTime:{type:String,default:""}},emits:["close","save"],setup(S,{emit:y}){const s=S,b=y,g=[{label:"è‰ç¨¿",value:"draft"},{label:"é å‘Š",value:"announce"},{label:"æ”¶å–®ä¸­",value:"open"},{label:"å·²çµå–®",value:"closed"},{label:"å‡ºè²¨çµæŸ",value:"shipped"}],p=k(s.initialStatus),i=k(s.initialStartTime),V=k(s.initialEndTime),D=k([]),T=k(""),r=k(null),f=x(()=>{if(!s.dateLabel)return"";const o=s.dateLabel.split("/");return o.length===3?`${o[1]}/${o[2]}`:s.dateLabel});ve(()=>[s.initialProducts,s.initialStatus,s.initialStartTime,s.initialEndTime],()=>{p.value=s.initialStatus,i.value=s.initialStartTime,V.value=s.initialEndTime,D.value=s.initialProducts.map(o=>({id:o.id,name:o.name,max:o.max??null})),T.value=""},{immediate:!0});const O=x(()=>D.value.map(o=>o.id)),R=()=>{if(!r.value)return;const o=r.value.getProductById(T.value);if(!o)return;if(D.value.some(W=>W.id===o.id)){ye.warning("æ­¤ç”¢å“å·²åœ¨åˆ—è¡¨ä¸­"),T.value="";return}D.value.push({id:o.id,name:o.name,max:0}),T.value=""},$=o=>{D.value=D.value.filter(v=>v.id!==o)},C=()=>{b("close")},M=()=>{b("save",{status:p.value,startTime:i.value,endTime:V.value,products:D.value.map(o=>({id:o.id,name:o.name,max:o.max??null}))})};return(o,v)=>{const W=G("Back"),q=le,j=oe,K=G("Check"),E=pe,c=se,d=ae,h=_e,L=fe,N=he;return t(),l("div",Ee,[e("div",we,[e("div",Ie,"ç·¨è¼¯"+n(f.value)+"çš„æŽ’ç¨‹",1),e("div",null,[a(j,{class:"editor-back",circle:"",onClick:C},{default:_(()=>[a(q,null,{default:_(()=>[a(W)]),_:1})]),_:1}),a(j,{class:"editor-save",type:"primary",circle:"",onClick:M},{default:_(()=>[a(q,null,{default:_(()=>[a(K)]),_:1})]),_:1})])]),e("div",Le,[e("div",Ne,[v[4]||(v[4]=e("div",{class:"section-title"},"æŽ’ç¨‹è³‡è¨Š",-1)),a(L,{class:"schedule-form","label-position":"top"},{default:_(()=>[e("div",Ae,[a(E,{label:"æ—¥æœŸ",class:"field"},{default:_(()=>[e("div",Be,n(S.dateLabel||"-"),1)]),_:1}),a(E,{label:"é–‹å–®ç‹€æ…‹",class:"field"},{default:_(()=>[a(d,{modelValue:p.value,"onUpdate:modelValue":v[0]||(v[0]=m=>p.value=m),placeholder:"é¸æ“‡ç‹€æ…‹"},{default:_(()=>[(t(),l(H,null,F(g,m=>a(c,{key:m.value,label:m.label,value:m.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),e("div",He,[a(E,{label:"é–‹å–®é–‹å§‹æ™‚é–“",class:"field"},{default:_(()=>[a(h,{modelValue:i.value,"onUpdate:modelValue":v[1]||(v[1]=m=>i.value=m),placeholder:"é–‹å§‹æ™‚é–“",format:"HH:mm","value-format":"HH:mm"},null,8,["modelValue"])]),_:1}),a(E,{label:"é–‹å–®æˆªæ­¢æ™‚é–“",class:"field"},{default:_(()=>[a(h,{modelValue:V.value,"onUpdate:modelValue":v[2]||(v[2]=m=>V.value=m),placeholder:"æˆªæ­¢æ™‚é–“",format:"HH:mm","value-format":"HH:mm"},null,8,["modelValue"])]),_:1})])]),_:1})]),e("div",Fe,[v[6]||(v[6]=e("div",{class:"section-title"},"ä»Šæ—¥å‡ºçˆç”¢å“",-1)),e("div",je,[e("div",Ue,[a(Me,{ref_key:"selectProductRef",ref:r,modelValue:T.value,"onUpdate:modelValue":v[3]||(v[3]=m=>T.value=m),class:"product-select","exclude-ids":O.value},null,8,["modelValue","exclude-ids"]),a(j,{type:"primary",icon:"plus",circle:"",disabled:!T.value,onClick:R},null,8,["disabled"])]),D.value.length===0?(t(),l("div",ze," å°šæœªæ–°å¢žç”¢å“ ")):(t(),l("div",We,[(t(!0),l(H,null,F(D.value,m=>(t(),l("div",{key:m.id,class:"product-wrapper"},[e("div",qe,[e("div",Ge,[e("div",Je,n(m.name),1)]),e("div",Ke,[v[5]||(v[5]=e("div",{class:"field-label"},"å¯å”®ä¸Šé™",-1)),a(N,{modelValue:m.max,"onUpdate:modelValue":U=>m.max=U,min:0,max:999,size:"small"},null,8,["modelValue","onUpdate:modelValue"])])]),a(j,{type:"danger",plain:"",icon:"delete",size:"small",onClick:U=>$(m.id)},null,8,["onClick"])]))),128))]))])])])])}}},Ze=Q(Xe,[["__scopeId","data-v-cb0432ee"]]),Qe={class:"schedule-container"},et={class:"schedule-header"},tt={class:"header-top"},st={class:"month-navigation"},at={class:"month-label"},lt={class:"schedule-main"},ot={key:1,class:"schedule-right"},dt={class:"detail-header"},nt={key:0,class:"detail-stats"},it={class:"stat-ordered"},ct={class:"stat-completed"},ut={class:"stat-cancelled"},rt={class:"detail-actions"},mt={class:"detail-content"},vt={key:0,class:"products-section"},pt={class:"section-title"},_t={class:"count"},ft={class:"products-grid"},ht={class:"product-info"},yt={class:"product-name"},bt={class:"product-category"},kt={class:"product-footer"},gt={class:"product-price"},Dt={key:0,class:"product-stock"},Ot={key:1,class:"product-sold-out"},Pt={key:1,class:"orders-section"},$t={class:"section-title"},St={class:"count"},Tt={class:"orders-list"},Rt={class:"order-id"},Ct={class:"order-customer"},Vt={class:"name"},Yt={class:"order-time"},xt={class:"order-items"},Mt={class:"order-amount"},Et={key:2,class:"empty-orders"},wt={__name:"schedule",setup(S){const y=k(w()),s=k(null),b=k([]),g=k(!1),p=k({status:"draft",startTime:"",endTime:"",products:[]}),i=k([{id:"PROD-001",name:"ä¸¹éº¥ç‰›è§’éºµåŒ…",category:"ç‰›è§’éºµåŒ…",image:"ðŸ¥",price:45,stock:25,available:!0},{id:"PROD-002",name:"æ³•å¼é•·æ£éºµåŒ…",category:"åå¸",image:"ðŸž",price:65,stock:15,available:!0},{id:"PROD-003",name:"æ ¸æ¡ƒæå­éºµåŒ…",category:"è»ŸéºµåŒ…",image:"ðŸž",price:55,stock:20,available:!0}]),V={"2026-02-16":["PROD-001","PROD-002","PROD-003","PROD-004","PROD-006"],"2026-02-15":["PROD-001","PROD-003","PROD-005","PROD-006"],"2026-02-17":["PROD-002","PROD-004","PROD-005"],"2026-02-18":["PROD-001","PROD-002","PROD-003","PROD-004"]},D=k([{id:"ORD-20260216-001",customerName:"é™³å°ç¾Ž",pickupTime:"2026-02-16 14:00",status:"ordered",totalAmount:465,items:2},{id:"ORD-20260216-002",customerName:"çŽ‹å¤§æ˜Ž",pickupTime:"2026-02-16 15:30",status:"ordered",totalAmount:605,items:2},{id:"ORD-20260216-004",customerName:"é­å¿—è»’",pickupTime:"2026-02-16 10:30",status:"ordered",totalAmount:1290,items:7},{id:"ORD-20260216-009",customerName:"é„’èŠŠèŠŠ",pickupTime:"2026-02-16 15:00",status:"ordered",totalAmount:895,items:5},{id:"ORD-20260216-013",customerName:"å³æ˜€åº­",pickupTime:"2026-02-16 17:30",status:"ordered",totalAmount:2770,items:6},{id:"ORD-20260215-015",customerName:"å¼µé›…èŠ³",pickupTime:"2026-02-15 18:00",status:"completed",totalAmount:540,items:2},{id:"ORD-20260215-014",customerName:"åŠ‰å»ºåœ‹",pickupTime:"2026-02-15 17:30",status:"cancelled",totalAmount:330,items:1},{id:"ORD-20260217-001",customerName:"é»ƒå¿—æ˜Ž",pickupTime:"2026-02-17 10:00",status:"ordered",totalAmount:555,items:2},{id:"ORD-20260217-002",customerName:"æŽæ·‘èŠ¬",pickupTime:"2026-02-17 14:30",status:"ordered",totalAmount:300,items:1},{id:"ORD-20260218-001",customerName:"å‘¨ç¾ŽçŽ²",pickupTime:"2026-02-18 11:00",status:"ordered",totalAmount:580,items:2}]),T=()=>{const c=[],d=y.value.startOf("month"),h=y.value.endOf("month"),L=d.day(),N=d.subtract(L,"day"),U=6-h.day(),u=h.add(U,"day");let A=N;for(;A.isBefore(u)||A.isSame(u);){const ee=A.format("YYYY-MM-DD"),B=D.value.filter(P=>P.pickupTime.startsWith(ee)),de=A.format("YYYY-MM"),ne=y.value.format("YYYY-MM"),ie=de===ne,ce={total:B.length,ordered:B.filter(P=>P.status==="ordered").length,completed:B.filter(P=>P.status==="completed").length,cancelled:B.filter(P=>P.status==="cancelled").length,revenue:B.filter(P=>P.status!=="cancelled").reduce((P,X)=>P+X.totalAmount,0)};c.push({date:ee,dateObj:A.clone(),orders:B.sort((P,X)=>w(P.pickupTime).diff(w(X.pickupTime))),stats:ce,isOpen:!0,hasOrders:B.length>0,isCurrentMonth:ie}),A=A.add(1,"day")}return c};b.value=T();const r=()=>{b.value=T();const c=w().format("YYYY-MM-DD"),d=b.value.find(h=>h.date===c);if(d&&d.hasOrders)s.value=c;else{const h=b.value.find(L=>L.isCurrentMonth);s.value=h?.date||null}};r();const f=()=>{r()},Y=()=>{y.value=y.value.subtract(1,"month"),f()},O=()=>{y.value=y.value.add(1,"month"),f()},R=()=>{y.value=w(),s.value=null,f()},$=x(()=>y.value.format("YYYY å¹´ M æœˆ")),C=x(()=>s.value?b.value.find(c=>c.date===s.value)?.orders||[]:[]),M=x(()=>s.value&&b.value.find(c=>c.date===s.value)?.stats||null),o=x(()=>s.value?(V[s.value]||[]).map(d=>i.value.find(h=>h.id===d)).filter(Boolean):[]),v=x(()=>s.value?w(s.value).format("YYYY/MM/DD"):""),W=c=>({ordered:"å·²ä¸‹å–®",completed:"å·²å®Œæˆ",cancelled:"å·²å–æ¶ˆ"})[c]||c,q=c=>({ordered:"#3b82f6",completed:"#10b981",cancelled:"#ef4444"})[c]||"#6b7280",j=c=>w(c).format("HH:mm"),K=()=>{p.value={status:"draft",startTime:"",endTime:"",products:o.value.map(c=>({id:c.id,name:c.name,limit:c.stock??0,max:c.stock??null}))},g.value=!0},E=()=>{g.value=!1};return(c,d)=>{const h=oe,L=G("Close"),N=le,m=G("More"),U=G("Document");return t(),l("div",Qe,[e("div",et,[e("div",tt,[d[3]||(d[3]=e("div",null,[e("h2",null,"æŽ¥å–®æŽ’ç¨‹"),e("p",{class:"subtitle"},"ç®¡ç†æ¯æ—¥æŽ¥å–®ç‹€æ³ï¼Œå¿«é€ŸæŸ¥çœ‹è¨‚å–®è³‡è¨Š")],-1)),a(h,{type:"primary",icon:"Back",onClick:R},{default:_(()=>[...d[2]||(d[2]=[Z(" å›žåˆ°ä»Šå¤© ",-1)])]),_:1})]),e("div",st,[a(h,{icon:"ArrowLeft",circle:"",onClick:Y}),e("span",at,n($.value),1),a(h,{icon:"ArrowRight",circle:"",onClick:O})])]),e("div",lt,[g.value?(t(),z(Ze,{key:0,"date-label":v.value,"available-products":i.value,"initial-products":p.value.products,"initial-status":p.value.status,"initial-start-time":p.value.startTime,"initial-end-time":p.value.endTime,onClose:E,onSave:E},null,8,["date-label","available-products","initial-products","initial-status","initial-start-time","initial-end-time"])):s.value?(t(),l("div",ot,[e("div",dt,[e("div",null,[e("h3",null,n(be(w)(s.value).format("YYYY å¹´ M æœˆ DD æ—¥ (ddd)")),1),M.value?(t(),l("p",nt,[Z(" å…± "+n(M.value.total)+" ç­†è¨‚å–® | ",1),e("span",it,"â†“ "+n(M.value.ordered),1),e("span",ct,"âœ“ "+n(M.value.completed),1),e("span",ut,"âœ• "+n(M.value.cancelled),1),Z(" | ç‡Ÿæ”¶ $"+n(M.value.revenue),1)])):I("",!0)]),e("div",rt,[a(h,{class:"detail-more",circle:"",onClick:d[0]||(d[0]=u=>g.value?E():K())},{default:_(()=>[g.value?(t(),z(N,{key:0},{default:_(()=>[a(L)]),_:1})):(t(),z(N,{key:1},{default:_(()=>[a(m)]),_:1}))]),_:1})])]),e("div",mt,[o.value.length>0?(t(),l("div",vt,[e("div",pt,[d[4]||(d[4]=e("span",null,"ä»Šæ—¥å‡ºçˆ",-1)),e("span",_t,n(o.value.length)+" é …å•†å“",1)]),e("div",ft,[(t(!0),l(H,null,F(o.value,u=>(t(),l("div",{key:u.id,class:J(["product-card",{"out-of-stock":!u.available}])},[e("div",ht,[e("h4",yt,n(u.name),1),e("p",bt,n(u.category),1),e("div",kt,[e("span",gt,"$"+n(u.price),1),u.available?(t(),l("span",Dt,n(u.stock)+" å€‹",1)):(t(),l("span",Ot,"å·²å”®å®Œ"))])])],2))),128))])])):I("",!0),C.value.length>0?(t(),l("div",Pt,[e("div",$t,[d[5]||(d[5]=e("span",null,"è¨‚å–®æ¸…å–®",-1)),e("span",St,n(C.value.length)+" ç­†",1)]),e("div",Tt,[(t(!0),l(H,null,F(C.value,u=>(t(),l("div",{key:u.id,class:"order-row",style:te({borderLeftColor:q(u.status)})},[e("div",Rt,n(u.id),1),e("div",Ct,[e("span",Vt,n(u.customerName),1)]),e("div",Yt,n(j(u.pickupTime)),1),e("div",xt,n(u.items)+" é …",1),e("div",Mt,"$"+n(u.totalAmount),1),e("div",{class:"order-status",style:te({background:q(u.status)})},n(W(u.status)),5)],4))),128))])])):I("",!0),C.value.length===0&&o.value.length===0?(t(),l("div",Et,[a(N,null,{default:_(()=>[a(U)]),_:1}),d[6]||(d[6]=e("p",null,"è©²æ—¥æœŸæš«ç„¡è¨‚å–®åŠå•†å“",-1))])):I("",!0)])])):I("",!0),a(xe,{"schedule-list":b.value,"selected-date":s.value,onSelect:d[1]||(d[1]=u=>s.value=u)},null,8,["schedule-list","selected-date"])])])}}},Ht=Q(wt,[["__scopeId","data-v-ffcafc84"]]);export{Ht as default};

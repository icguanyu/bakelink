import{a0 as r,a8 as c,r as s,a9 as l}from"./index-DLQBT_Le.js";const g={Login:e=>r.post("/auth/login",e),Me:()=>r.get("/auth/me")},n="bakelink-token",k=c("auth",()=>{const e=s(localStorage.getItem(n)||""),o=s(!1),u=t=>{e.value=t,localStorage.setItem(n,t),l.defaults.headers.common.Authorization=`Bearer ${t}`};return{token:e,loading:o,login:async({email:t,password:i})=>{if(o.value)return null;o.value=!0;try{const a=(await g.Login({email:t,password:i})).data.token;if(!a)throw new Error("登入失敗，未取得 token");return u(a),a}finally{o.value=!1}},logout:()=>{e.value="",localStorage.removeItem(n),delete l.defaults.headers.common.Authorization}}});export{k as u};

import{r as p,l as f,M as S,x as i,o as s,w as y,c as g,F as v,y as b,a1 as V,K as P,L as B}from"./index-BbS6ciBb.js";/* empty css               */import{a as k}from"./products-OpGadVTE.js";const C={__name:"SelectProduct",props:{modelValue:[String,Number],placeholder:{type:String,default:"請選擇產品"},excludeIds:{type:Array,default:()=>[]},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(r,{expose:_,emit:w}){const m=r,u=p(!1),d=p([]),h=f(()=>{const e=new Set(m.excludeIds);return d.value.filter(l=>!e.has(l.id))}),x=f(()=>{const e=new Set(m.excludeIds),l=d.value.filter(t=>!e.has(t.id)),o={};return l.forEach(t=>{const n=t.category_id,a=t.category?.name||t.category_name||"未分類";o[n]||(o[n]={label:a,categoryId:n,options:[]}),o[n].options.push({value:t.id,label:t.name})}),Object.values(o)}),I=async()=>{u.value=!0;try{const e=await k.List({});console.log("products",e),d.value=e.data.data||[]}catch(e){console.error("fetch data error",e)}finally{u.value=!1}};return S(()=>{I()}),_({getProductById:e=>d.value.find(l=>l.id===e)}),(e,l)=>{const o=P,t=V,n=B;return s(),i(n,{modelValue:r.modelValue,onClear:l[0]||(l[0]=a=>e.$emit("update:modelValue",null)),"onUpdate:modelValue":l[1]||(l[1]=a=>e.$emit("update:modelValue",a)),placeholder:r.placeholder,loading:u.value,disabled:r.disabled||h.value.length===0},{default:y(()=>[(s(!0),g(v,null,b(x.value,a=>(s(),i(t,{key:a.categoryId,label:a.label},{default:y(()=>[(s(!0),g(v,null,b(a.options,c=>(s(),i(o,{key:c.value,label:c.label,value:c.value},null,8,["label","value"]))),128))]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","placeholder","loading","disabled"])}}};export{C as _};

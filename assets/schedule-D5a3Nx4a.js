import{_ as ee,c as d,o as s,Z as me,b as e,F as I,y as B,q as G,t as i,v as E,r as k,l as V,M as ve,x as j,w as y,$ as pe,K as le,L as oe,I as _e,n as z,d as l,J as de,f as ne,E as fe,a0 as he,j as ye,a1 as be,k as ke,m as M,h as X,g as De,R as se}from"./index-DqZEbOiU.js";/* empty css                     *//* empty css                  *//* empty css            *//* empty css               */import{a as ge}from"./products-D9fYiblp.js";const Ye={class:"schedule-left"},Oe={class:"schedule-list"},Pe=["onClick"],Me={class:"date-section"},$e={class:"date-value"},Se={key:0,class:"mini-stats"},Te={key:0,class:"stat-badge ordered"},Re={key:1,class:"stat-badge completed"},Ce={key:2,class:"stat-badge cancelled"},xe={key:1,class:"no-orders-tag"},Ve={__name:"ScheduleCalendar",props:{scheduleList:{type:Array,required:!0},selectedDate:{type:String,default:null}},emits:["select"],setup($,{emit:p}){const t=p,b=D=>{t("select",D)};return(D,_)=>(s(),d("div",Ye,[_[0]||(_[0]=me('<div class="schedule-week-header" data-v-91bf7fee><div class="week-day" data-v-91bf7fee>æ—¥</div><div class="week-day" data-v-91bf7fee>ä¸€</div><div class="week-day" data-v-91bf7fee>äºŒ</div><div class="week-day" data-v-91bf7fee>ä¸‰</div><div class="week-day" data-v-91bf7fee>å››</div><div class="week-day" data-v-91bf7fee>äº”</div><div class="week-day" data-v-91bf7fee>å…­</div></div>',1)),e("div",Oe,[(s(!0),d(I,null,B($.scheduleList,c=>(s(),d("div",{key:c.date,class:G(["schedule-item",{"item-selected":$.selectedDate===c.date,"not-current-month":!c.isCurrentMonth}]),onClick:R=>b(c.date)},[e("div",{class:G(["schedule-header-row",{"no-orders":!c.hasOrders}])},[e("div",Me,[e("div",{class:G(["date-box",{saturday:c.dateObj.day()===6,sunday:c.dateObj.day()===0}])},[e("div",$e,i(c.dateObj.format("DD")),1)],2)]),c.hasOrders?(s(),d("div",Se,[c.stats.ordered>0?(s(),d("span",Te," â†“ "+i(c.stats.ordered),1)):E("",!0),c.stats.completed>0?(s(),d("span",Re," âœ“ "+i(c.stats.completed),1)):E("",!0),c.stats.cancelled>0?(s(),d("span",Ce," âœ• "+i(c.stats.cancelled),1)):E("",!0)])):(s(),d("div",xe,"æœªé–‹å–®"))],2)],10,Pe))),128))])]))}},we=ee(Ve,[["__scopeId","data-v-91bf7fee"]]),Ee={__name:"SelectProduct",props:{modelValue:[String,Number],placeholder:{type:String,default:"è«‹é¸æ“‡ç”¢å“"},excludeIds:{type:Array,default:()=>[]},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup($,{expose:p,emit:t}){const b=$,D=k(!1),_=k([]),c=V(()=>{const v=new Set(b.excludeIds);return _.value.filter(f=>!v.has(f.id))}),R=V(()=>{const v=new Set(b.excludeIds),f=_.value.filter(Y=>!v.has(Y.id)),C={};return f.forEach(Y=>{const T=Y.category_id,P=Y.category?.name||Y.category_name||"æœªåˆ†é¡ž";C[T]||(C[T]={label:P,categoryId:T,options:[]}),C[T].options.push({value:Y.id,label:Y.name})}),Object.values(C)}),g=async()=>{D.value=!0;try{const v=await ge.List({});console.log("products",v),_.value=v.data.data||[]}catch(v){console.error("fetch data error",v)}finally{D.value=!1}};return ve(()=>{g()}),p({getProductById:v=>_.value.find(f=>f.id===v)}),(v,f)=>{const C=le,Y=pe,T=oe;return s(),j(T,{modelValue:$.modelValue,onClear:f[0]||(f[0]=P=>v.$emit("update:modelValue",null)),"onUpdate:modelValue":f[1]||(f[1]=P=>v.$emit("update:modelValue",P)),placeholder:$.placeholder,loading:D.value,disabled:$.disabled||c.value.length===0},{default:y(()=>[(s(!0),d(I,null,B(R.value,P=>(s(),j(Y,{key:P.categoryId,label:P.label},{default:y(()=>[(s(!0),d(I,null,B(P.options,L=>(s(),j(C,{key:L.value,label:L.label,value:L.value},null,8,["label","value"]))),128))]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","placeholder","loading","disabled"])}}},Le={class:"schedule-editor"},Ne={class:"editor-header"},Ae={class:"editor-title"},Ie={class:"editor-body"},Be={class:"editor-section"},He={class:"field-row"},Fe={class:"field-value"},je={class:"field-row"},Ue={class:"editor-section"},ze={class:"section-content"},We={class:"field-row add-row"},qe={key:0,class:"empty-products"},Ge={key:1,class:"product-list"},Je={class:"product-item"},Ke={class:"product-info"},Ze={class:"product-name"},Qe={class:"product-limit"},Xe={__name:"ScheduleEditor",props:{dateLabel:{type:String,default:""},initialProducts:{type:Array,default:()=>[]},initialStatus:{type:String,default:"draft"},initialStartTime:{type:String,default:""},initialEndTime:{type:String,default:""}},emits:["close","save"],setup($,{emit:p}){const t=$,b=p,D=[{label:"è‰ç¨¿",value:"draft"},{label:"é å‘Š",value:"announce"},{label:"æ”¶å–®ä¸­",value:"open"},{label:"å·²çµå–®",value:"closed"},{label:"å‡ºè²¨çµæŸ",value:"shipped"}],_=k(t.initialStatus),c=k(t.initialStartTime),R=k(t.initialEndTime),g=k([]),S=k(""),v=k(null),f=V(()=>{if(!t.dateLabel)return"";const n=t.dateLabel.split("/");return n.length===3?`${n[1]}/${n[2]}`:t.dateLabel});_e(()=>[t.initialProducts,t.initialStatus,t.initialStartTime,t.initialEndTime],()=>{_.value=t.initialStatus,c.value=t.initialStartTime,R.value=t.initialEndTime,g.value=t.initialProducts.map(n=>({id:n.id,name:n.name,max:n.max??null})),S.value=""},{immediate:!0});const Y=V(()=>g.value.map(n=>n.id)),T=()=>{if(!v.value)return;const n=v.value.getProductById(S.value);if(!n)return;if(g.value.some(x=>x.id===n.id)){ke.warning("æ­¤ç”¢å“å·²åœ¨åˆ—è¡¨ä¸­"),S.value="";return}g.value.push({id:n.id,name:n.name,max:0}),S.value=""},P=n=>{g.value=g.value.filter(r=>r.id!==n)},L=()=>{b("close")},J=()=>{b("save",{status:_.value,startTime:c.value,endTime:R.value,products:g.value.map(n=>({id:n.id,name:n.name,max:n.max??null}))})};return(n,r)=>{const x=z("Back"),W=de,H=ne,q=z("Check"),F=fe,K=le,U=oe,o=he,a=ye,h=be;return s(),d("div",Le,[e("div",Ne,[e("div",Ae,"ç·¨è¼¯"+i(f.value)+"çš„æŽ’ç¨‹",1),e("div",null,[l(H,{class:"editor-back",circle:"",onClick:L},{default:y(()=>[l(W,null,{default:y(()=>[l(x)]),_:1})]),_:1}),l(H,{class:"editor-save",type:"primary",circle:"",onClick:J},{default:y(()=>[l(W,null,{default:y(()=>[l(q)]),_:1})]),_:1})])]),e("div",Ie,[e("div",Be,[r[4]||(r[4]=e("div",{class:"section-title"},"æŽ’ç¨‹è³‡è¨Š",-1)),l(a,{class:"schedule-form","label-position":"top"},{default:y(()=>[e("div",He,[l(F,{label:"æ—¥æœŸ",class:"field"},{default:y(()=>[e("div",Fe,i($.dateLabel||"-"),1)]),_:1}),l(F,{label:"é–‹å–®ç‹€æ…‹",class:"field"},{default:y(()=>[l(U,{modelValue:_.value,"onUpdate:modelValue":r[0]||(r[0]=u=>_.value=u),placeholder:"é¸æ“‡ç‹€æ…‹"},{default:y(()=>[(s(),d(I,null,B(D,u=>l(K,{key:u.value,label:u.label,value:u.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),e("div",je,[l(F,{label:"é–‹å–®é–‹å§‹æ™‚é–“",class:"field"},{default:y(()=>[l(o,{modelValue:c.value,"onUpdate:modelValue":r[1]||(r[1]=u=>c.value=u),placeholder:"é–‹å§‹æ™‚é–“",format:"HH:mm","value-format":"HH:mm"},null,8,["modelValue"])]),_:1}),l(F,{label:"é–‹å–®æˆªæ­¢æ™‚é–“",class:"field"},{default:y(()=>[l(o,{modelValue:R.value,"onUpdate:modelValue":r[2]||(r[2]=u=>R.value=u),placeholder:"æˆªæ­¢æ™‚é–“",format:"HH:mm","value-format":"HH:mm"},null,8,["modelValue"])]),_:1})])]),_:1})]),e("div",Ue,[r[6]||(r[6]=e("div",{class:"section-title"},"ä»Šæ—¥å‡ºçˆç”¢å“",-1)),e("div",ze,[e("div",We,[l(Ee,{ref_key:"selectProductRef",ref:v,modelValue:S.value,"onUpdate:modelValue":r[3]||(r[3]=u=>S.value=u),class:"product-select","exclude-ids":Y.value},null,8,["modelValue","exclude-ids"]),l(H,{type:"primary",icon:"plus",circle:"",disabled:!S.value,onClick:T},null,8,["disabled"])]),g.value.length===0?(s(),d("div",qe," å°šæœªæ–°å¢žç”¢å“ ")):(s(),d("div",Ge,[(s(!0),d(I,null,B(g.value,u=>(s(),d("div",{key:u.id,class:"product-wrapper"},[e("div",Je,[e("div",Ke,[e("div",Ze,i(u.name),1)]),e("div",Qe,[r[5]||(r[5]=e("div",{class:"field-label"},"å¯å”®ä¸Šé™",-1)),l(h,{modelValue:u.max,"onUpdate:modelValue":w=>u.max=w,min:0,max:999,size:"small"},null,8,["modelValue","onUpdate:modelValue"])])]),l(H,{type:"danger",plain:"",icon:"delete",size:"small",onClick:w=>P(u.id)},null,8,["onClick"])]))),128))]))])])])])}}},et=ee(Xe,[["__scopeId","data-v-cb0432ee"]]),tt={class:"schedule-container"},at={class:"schedule-header"},st={class:"header-top"},lt={class:"month-navigation"},ot={class:"month-label"},dt={class:"schedule-main"},nt={key:1,class:"schedule-right"},it={class:"detail-header"},ct={class:"detail-header-left"},rt={key:0,class:"detail-stats"},ut={class:"stat-ordered"},mt={class:"stat-completed"},vt={class:"stat-cancelled"},pt={class:"detail-actions"},_t={class:"detail-content"},ft={key:0,class:"products-section"},ht={class:"section-title"},yt={class:"count"},bt={class:"products-grid"},kt={class:"product-info"},Dt={class:"product-name"},gt={class:"product-category"},Yt={class:"product-footer"},Ot={class:"product-price"},Pt={key:0,class:"product-stock"},Mt={key:1,class:"product-sold-out"},$t={key:1,class:"orders-section"},St={class:"section-title"},Tt={class:"count"},Rt={class:"orders-list"},Ct={class:"order-id"},xt={class:"order-customer"},Vt={class:"name"},wt={class:"order-time"},Et={class:"order-items"},Lt={class:"order-amount"},Nt={key:2,class:"empty-orders"},At={__name:"schedule",setup($){const p=k(M()),t=k(null),b=k([]),D=k(!1),_=k({status:"draft",startTime:"",endTime:"",products:[]}),c=k([{id:"PROD-001",name:"ä¸¹éº¥ç‰›è§’éºµåŒ…",category:"ç‰›è§’éºµåŒ…",image:"ðŸ¥",price:45,stock:25,available:!0},{id:"PROD-002",name:"æ³•å¼é•·æ£éºµåŒ…",category:"åå¸",image:"ðŸž",price:65,stock:15,available:!0},{id:"PROD-003",name:"æ ¸æ¡ƒæå­éºµåŒ…",category:"è»ŸéºµåŒ…",image:"ðŸž",price:55,stock:20,available:!0}]),R={"2026-02-16":["PROD-001","PROD-002","PROD-003","PROD-004","PROD-006"],"2026-02-15":["PROD-001","PROD-003","PROD-005","PROD-006"],"2026-02-17":["PROD-002","PROD-004","PROD-005"],"2026-02-18":["PROD-001","PROD-002","PROD-003","PROD-004"]},g=k([{id:"ORD-20260216-001",customerName:"é™³å°ç¾Ž",pickupTime:"2026-02-16 14:00",status:"ordered",totalAmount:465,items:2},{id:"ORD-20260216-002",customerName:"çŽ‹å¤§æ˜Ž",pickupTime:"2026-02-16 15:30",status:"ordered",totalAmount:605,items:2},{id:"ORD-20260216-004",customerName:"é­å¿—è»’",pickupTime:"2026-02-16 10:30",status:"ordered",totalAmount:1290,items:7},{id:"ORD-20260216-009",customerName:"é„’èŠŠèŠŠ",pickupTime:"2026-02-16 15:00",status:"ordered",totalAmount:895,items:5},{id:"ORD-20260216-013",customerName:"å³æ˜€åº­",pickupTime:"2026-02-16 17:30",status:"ordered",totalAmount:2770,items:6},{id:"ORD-20260215-015",customerName:"å¼µé›…èŠ³",pickupTime:"2026-02-15 18:00",status:"completed",totalAmount:540,items:2},{id:"ORD-20260215-014",customerName:"åŠ‰å»ºåœ‹",pickupTime:"2026-02-15 17:30",status:"cancelled",totalAmount:330,items:1},{id:"ORD-20260217-001",customerName:"é»ƒå¿—æ˜Ž",pickupTime:"2026-02-17 10:00",status:"ordered",totalAmount:555,items:2},{id:"ORD-20260217-002",customerName:"æŽæ·‘èŠ¬",pickupTime:"2026-02-17 14:30",status:"ordered",totalAmount:300,items:1},{id:"ORD-20260218-001",customerName:"å‘¨ç¾ŽçŽ²",pickupTime:"2026-02-18 11:00",status:"ordered",totalAmount:580,items:2}]),S=()=>{const o=[],a=p.value.startOf("month"),h=p.value.endOf("month"),u=a.day(),w=a.subtract(u,"day"),Z=6-h.day(),m=h.add(Z,"day");let N=w;for(;N.isBefore(m)||N.isSame(m);){const ae=N.format("YYYY-MM-DD"),A=g.value.filter(O=>O.pickupTime.startsWith(ae)),ie=N.format("YYYY-MM"),ce=p.value.format("YYYY-MM"),re=ie===ce,ue={total:A.length,ordered:A.filter(O=>O.status==="ordered").length,completed:A.filter(O=>O.status==="completed").length,cancelled:A.filter(O=>O.status==="cancelled").length,revenue:A.filter(O=>O.status!=="cancelled").reduce((O,Q)=>O+Q.totalAmount,0)};o.push({date:ae,dateObj:N.clone(),orders:A.sort((O,Q)=>M(O.pickupTime).diff(M(Q.pickupTime))),stats:ue,isOpen:!0,hasOrders:A.length>0,isCurrentMonth:re}),N=N.add(1,"day")}return o};b.value=S();const v=()=>{b.value=S();const o=M().format("YYYY-MM-DD"),a=b.value.find(h=>h.date===o);if(a&&a.hasOrders)t.value=o;else{const h=b.value.find(u=>u.isCurrentMonth);t.value=h?.date||null}};v();const f=()=>{v()},C=()=>{p.value=p.value.subtract(1,"month"),f()},Y=()=>{p.value=p.value.add(1,"month"),f()},T=()=>{p.value=M(),t.value=null,f()},P=()=>{if(!t.value){t.value=M().format("YYYY-MM-DD");return}const a=M(t.value).subtract(1,"day");a.format("YYYY-MM")!==p.value.format("YYYY-MM")&&(p.value=a,f()),t.value=a.format("YYYY-MM-DD")},L=()=>{if(!t.value){t.value=M().format("YYYY-MM-DD");return}const a=M(t.value).add(1,"day");a.format("YYYY-MM")!==p.value.format("YYYY-MM")&&(p.value=a,f()),t.value=a.format("YYYY-MM-DD")},J=V(()=>p.value.format("YYYY å¹´ M æœˆ")),n=V(()=>t.value?b.value.find(o=>o.date===t.value)?.orders||[]:[]),r=V(()=>t.value&&b.value.find(o=>o.date===t.value)?.stats||null),x=V(()=>t.value?(R[t.value]||[]).map(a=>c.value.find(h=>h.id===a)).filter(Boolean):[]),W=V(()=>t.value?M(t.value).format("YYYY/MM/DD"):""),H=o=>({ordered:"å·²ä¸‹å–®",completed:"å·²å®Œæˆ",cancelled:"å·²å–æ¶ˆ"})[o]||o,q=o=>({ordered:"#3b82f6",completed:"#10b981",cancelled:"#ef4444"})[o]||"#6b7280",F=o=>M(o).format("HH:mm"),K=()=>{_.value={status:"draft",startTime:"",endTime:"",products:x.value.map(o=>({id:o.id,name:o.name,limit:o.stock??0,max:o.stock??null}))},D.value=!0},U=()=>{D.value=!1};return(o,a)=>{const h=ne,u=z("Close"),w=de,te=z("More"),Z=z("Document");return s(),d("div",tt,[e("div",at,[e("div",st,[a[3]||(a[3]=e("div",null,[e("h2",null,"æŽ¥å–®æŽ’ç¨‹"),e("p",{class:"subtitle"},"ç®¡ç†æ¯æ—¥æŽ¥å–®ç‹€æ³ï¼Œå¿«é€ŸæŸ¥çœ‹è¨‚å–®è³‡è¨Š")],-1)),l(h,{type:"primary",icon:"Back",onClick:T},{default:y(()=>[...a[2]||(a[2]=[X(" å›žåˆ°ä»Šå¤© ",-1)])]),_:1})]),e("div",lt,[l(h,{icon:"ArrowLeft",circle:"",onClick:C}),e("span",ot,i(J.value),1),l(h,{icon:"ArrowRight",circle:"",onClick:Y})])]),e("div",dt,[D.value?(s(),j(et,{key:0,"date-label":W.value,"available-products":c.value,"initial-products":_.value.products,"initial-status":_.value.status,"initial-start-time":_.value.startTime,"initial-end-time":_.value.endTime,onClose:U,onSave:U},null,8,["date-label","available-products","initial-products","initial-status","initial-start-time","initial-end-time"])):t.value?(s(),d("div",nt,[e("div",it,[e("div",ct,[l(h,{class:"day-nav-btn",icon:"ArrowLeft",circle:"",size:"small",onClick:P}),e("div",null,[e("h3",null,i(De(M)(t.value).format("YYYY å¹´ M æœˆ DD æ—¥ (ddd)")),1),r.value?(s(),d("p",rt,[X(" å…± "+i(r.value.total)+" ç­†è¨‚å–® | ",1),e("span",ut,"â†“ "+i(r.value.ordered),1),e("span",mt,"âœ“ "+i(r.value.completed),1),e("span",vt,"âœ• "+i(r.value.cancelled),1),X(" | ç‡Ÿæ”¶ $"+i(r.value.revenue),1)])):E("",!0)]),l(h,{class:"day-nav-btn",icon:"ArrowRight",circle:"",size:"small",onClick:L})]),e("div",pt,[l(h,{class:"detail-more",circle:"",onClick:a[0]||(a[0]=m=>D.value?U():K())},{default:y(()=>[D.value?(s(),j(w,{key:0},{default:y(()=>[l(u)]),_:1})):(s(),j(w,{key:1},{default:y(()=>[l(te)]),_:1}))]),_:1})])]),e("div",_t,[x.value.length>0?(s(),d("div",ft,[e("div",ht,[a[4]||(a[4]=e("span",null,"ä»Šæ—¥å‡ºçˆ",-1)),e("span",yt,i(x.value.length)+" é …å•†å“",1)]),e("div",bt,[(s(!0),d(I,null,B(x.value,m=>(s(),d("div",{key:m.id,class:G(["product-card",{"out-of-stock":!m.available}])},[e("div",kt,[e("h4",Dt,i(m.name),1),e("p",gt,i(m.category),1),e("div",Yt,[e("span",Ot,"$"+i(m.price),1),m.available?(s(),d("span",Pt,i(m.stock)+" å€‹",1)):(s(),d("span",Mt,"å·²å”®å®Œ"))])])],2))),128))])])):E("",!0),n.value.length>0?(s(),d("div",$t,[e("div",St,[a[5]||(a[5]=e("span",null,"è¨‚å–®æ¸…å–®",-1)),e("span",Tt,i(n.value.length)+" ç­†",1)]),e("div",Rt,[(s(!0),d(I,null,B(n.value,m=>(s(),d("div",{key:m.id,class:"order-row",style:se({borderLeftColor:q(m.status)})},[e("div",Ct,i(m.id),1),e("div",xt,[e("span",Vt,i(m.customerName),1)]),e("div",wt,i(F(m.pickupTime)),1),e("div",Et,i(m.items)+" é …",1),e("div",Lt,"$"+i(m.totalAmount),1),e("div",{class:"order-status",style:se({background:q(m.status)})},i(H(m.status)),5)],4))),128))])])):E("",!0),n.value.length===0&&x.value.length===0?(s(),d("div",Nt,[l(w,null,{default:y(()=>[l(Z)]),_:1}),a[6]||(a[6]=e("p",null,"è©²æ—¥æœŸæš«ç„¡è¨‚å–®åŠå•†å“",-1))])):E("",!0)])])):E("",!0),l(we,{"schedule-list":b.value,"selected-date":t.value,onSelect:a[1]||(a[1]=m=>t.value=m)},null,8,["schedule-list","selected-date"])])])}}},zt=ee(At,[["__scopeId","data-v-57cde3f1"]]);export{zt as default};

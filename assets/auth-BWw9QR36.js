import{x as r,a6 as c,r as s,a7 as l}from"./index-DHZAEWta.js";const g={Login:e=>r.post("/auth/login",e),Me:()=>r.get("/auth/me")},a="bakelink-token",k=c("auth",()=>{const e=s(localStorage.getItem(a)||""),o=s(!1),u=t=>{e.value=t,localStorage.setItem(a,t),l.defaults.headers.common.Authorization=`Bearer ${t}`};return{token:e,loading:o,login:async({email:t,password:i})=>{if(o.value)return null;o.value=!0;try{const n=(await g.Login({email:t,password:i})).data.token;if(!n)throw new Error("登入失敗，未取得 token");return u(n),n}finally{o.value=!1}},logout:()=>{e.value="",localStorage.removeItem(a),delete l.defaults.headers.common.Authorization}}});export{k as u};
